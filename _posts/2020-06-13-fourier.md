---
title: "fourier"
date: 2020-06-13 18:26:00 -0400
categories: etc
---

## 들어가기 전에

이 글은 컴공 학생이 컴공을 위한 푸리에 변환(정확히는 DCT까지)의 개념을 되짚어 가며 정리한 글이다. 

기본적으로는 내 기억을 되살리기 위한 글이지만, 인터넷에 공개하는 만큼 공부중인 학생이 읽으면 도움이 될 수 있도록 쓸 것이다.

증명이라던가 수렴 반경 등 엄밀한 얘기는 치워두고, 수학을 많이 까먹은 컴공, 조금 더 넓게는 고등학교 수학만 어렴풋이 기억하는 사람이 봤을 때 직관적으로 이해할 수 있도록 하는게 목적이다. 

## 의문

 *다항식을 무한히  조합하면 삼각함수랑 같아질 수 있을까?*  

중학생 때였나, 삼각함수의 그래프를 처음 봤을 때 대충 아래와 같은 그래프들을 끄적이며 한 생각이다. 

<p align="middle">
<iframe src="https://www.desmos.com/calculator/xx65om3vjb?embed" width="500px" height="200px" style="border: 1px solid #ccc" frameborder=0>&nbsp;</iframe>
</p>

$$ \sin(x) $$

<p align="middle">
<iframe src="https://www.desmos.com/calculator/idgktow4g3?embed" width="500px" height="200px" style="border: 1px solid #ccc" frameborder=0></iframe>
</p>

$$ \sin(x),-\frac{8}{3\pi^{3}}\left(x+\pi\right)x\left(x-\pi\right) $$

<p align="middle">
<iframe src="https://www.desmos.com/calculator/9mvyzgmi5b?embed" width="500px" height="200px" style="border: 1px solid #ccc" frameborder=0></iframe>
</p>

$$ \sin(x), \frac{16}{15\pi^{4}}\left(x+\pi\right)x\left(x-\pi\right)\left(x-2\pi\right) $$


즉, $\sin$ 처럼 $n\pi$에서 0이고, 극대값과 극소값을 1과 -1로 맞춰주면 비슷한 그래프가 되지 않을까 했던 것이다. 

$$ \sin(x) \approx a \dotsm \left(x+\pi\right)x\left(x-\pi\right)\dotsm $$

라고 쓸 수 있지 않겠냐는 뜻이다. 조금 울퉁불퉁 하지만 무한하게 곱하다보면 한없이 비슷해질 것이다. 그럴듯 하지 않나? ^^;

이 발상은 잠시동안 낙서를 한 뒤에 잊혀졌다. 아마 이런 점이 일반인과 역사에 이름을 남기는 사람을 가르는 부분 아닐까 싶은데...


## 테일러 급수 *Taylor series*

테일러 _Taylor_ 라는 아저씨는 낙서만으로는 만족을 못했는지 엄밀한 증명과 함께 어떤 함수를 다항식으로 표현하는 방법을 만들었고, 거기 자신의 이름을 붙였으니 그게 테일러 급수다. 

한국어 위키백과 기준 테일러 급수의 정의는 다음과 같다.  
> **테일러 급수**는 도함수들의 한 점에서의 값으로 계산된 항의 무한합으로 해석함수를 나타내는 방법이다.

엄밀함은 제껴두고 쉽게 말하자면, 예쁜 함수들의 어떤 점 $a$근처는 그 점에서의 미분값들을 이용해 표현할 수 있다는 뜻이다. 구체적인 수식으로 말하자면 다음과 같다.

$$ f(x) = f(a) + \frac{f'(a)}{1!} (x-a) + \frac{f''(a)}{2!} (x-a)^2 + \frac{f'''(a)}{3!} (x-a)^3 +\dotsm $$

이 식이 어떻게 나왔냐면.. 

## 테일러 급수 유도하기

어떤 함수 $f(x)$가 *아무튼 다항식으로 표현된다*고 가정하자. 수학적으로 바꿔 말하면, 다음과 같이 쓸 수 있다는 뜻이다.

$$ f(x) = a_0 + a_1x + a_2x^2 + \dotsm$$

즉 $a_0, a_1, a_2,\dotsm$만 구할 수 있다면, $f(x)$가 $\sin(x)$건 $e^x$건 똑같은 다항식을 찾아낼 수 있다는 뜻이다. 

그럼 $a_n$들을 찾아보자. 

양변에 $x=0$을 대입하면 $a_0$외의 항이 전부 0이 되므로, $a_0=f(0)$이다.

이제 $a_1, a_2, \dotsm$들을 구해야 하는데, 여러가지 방법이 있겠지만 $a_0$를 구한 것처럼 간단하게 구할 수 있으면 참 좋을 것 같다. 

같은 방법을 쓰려면 $a_1$에 붙어있는 $x$는 사라지고, $a_2, a_3, \dotsm$들에는 $x$가 붙어있고, $a_0$는 없어져야 한다. 

그리고 우리는 우연하게도 고등학교에서 그 방법을 배웠다. 바로 양변을 미분해주는 것이다. 

$$f'(x) = a_1 + 2a_2x +3a_3x^2 + \dotsm$$

$a_0$를 구했을 때와 마찬가지로  $x=0$을 대입하면 $a_1$외의 항이 전부 0이 되므로, $a_1=f'(0)$이다.

조금 더 관찰해보면, 양변을 n번 미분했을 때 $x^n$앞에 있던 숫자가 상수가 되고, 그 전의 숫자들은 지워지고, 그 뒤에는 $x$가 남아있을 것이라는 것도 상상할 수 있다.  

$$ f^{(n)} (x) = n![a_n + a_{n+1} (n+1)x + \dotsm]$$

$$ f^{(n+1)} (x) = (n+1)![a_{n+1} + a_{n+2} (n+2)x + \dotsm]$$
따라서, 

$$ a_n = \frac{f^{(n)} (0)}{n!} $$

이건 정확히는 $a=0$일때의 얘기지만, 그 외에서도 마찬가지로 쓸 수 있다. 

## 테일러 급수의 활용
 
중학생때의 나한테 답변을 해주자면, 그때 생각했던 형태와는 조금 다르지만 삼각함수는 다항식의 조합으로 표현할 수 있다.

위의 식에 대입해보자. 
$$ \sin(x) = \sin(0) + \frac{\sin'(0)}{1!} x + \frac{\sin''(0)}{2!} x^2 + \frac{\sin'''(0)}{3!} x^3 +\dotsm $$


예쁘게 정리해보면, 

$$ \sin(x) = x - \frac{x^3}{3!} + \frac{x^5}{5!}-\frac{x^7}{7!}+ \dotsm $$

혹시 테일러 아저씨가 거짓말을 한 건 아닌지 눈으로 확인해보자.

<p align="middle">
<iframe src="https://www.desmos.com/calculator/vf8dhxoled?embed" width="500px" height="200px" style="border: 1px solid #ccc" frameborder=0></iframe>
</p>

$$ \sin(x), x - \frac{x^3}{3!}  $$

<p align="middle">
<iframe src="https://www.desmos.com/calculator/4now20x7ov?embed" width="500px" height="200px" style="border: 1px solid #ccc" frameborder=0></iframe>
</p>

$$ \sin(x) , x - \frac{x^3}{3!} + \frac{x^5}{5!} $$

<p align="middle">
<iframe src="https://www.desmos.com/calculator/pndhn7wjvg?embed" width="500px" height="200px" style="border: 1px solid #ccc" frameborder=0></iframe>
</p>

$$ \sin(x) , x - \frac{x^3}{3!} + \frac{x^5}{5!}-\frac{x^7}{7!} $$

<p align="middle">
<iframe src="https://www.desmos.com/calculator/logtcniyfb?embed" width="500px" height="200px" style="border: 1px solid #ccc" frameborder=0></iframe>
</p>

$$ \sin(x) , x - \frac{x^3}{3!} + \frac{x^5}{5!}-\frac{x^7}{7!} +\dotsm +\frac{x^{19}}{19!} $$

더해주는 항이 많아질수록 $\sin(x)$에 가까워지는게 보인다. 보라색 그래프를 무한히 펼치면, $\sin(x)$와 **한없이 비슷해질 것이다**. 

테일러 급수는 내 오랜 의문에 답변이 된 것으로 끝나는 게 아니라, 공학적으로 큰 의미를 가진다. $\sin$, $\cos$같은 계산하기 껄끄러운 함수들을 단순한(?) 사칙연산들로 계산할 수 있게 되었기 때문이다.
예를 들어 $\sin(21.593^\circ)$ 따위의 값을 구할 때 $21.593^\circ$ 만큼 기운 직각삼각형을 그리고, 빗변과 높이의 길이를 자로 잰 다음, 빗변에 대한 높이의 비율을 구하는건 말도 안되기 때문에 테일러 급수를 이용해 계산하는데, 무한히 더할 수는 없기 때문에 적당히 잘라서 계산한다.[^1]

정리하자면, 우리는 테일러 급수를 활용해 __알기 어려운 함수들을 알기 쉬운 함수들로 바꿔서 쓸 수 있다__.

푸리에 변환이라면서 왜 테일러 급수를 길게도 써놓았냐 하면, 어떤 함수를 다른 형태로 바꾼다는 점에서 둘이 상당히 비슷하고, 다항식의 미분이라는 비교적 간단한 개념으로 설명할 수 있으면서, 그 계수를 유도하는 과정이 푸리에 변환과 비슷해 비교해가며 생각하기 쉽기 때문이다. 

 이제 진짜 하려고 했던 푸리에 얘기로 넘어가보자. 
 
  [^1]: 전문용어) 근사한다
  
  
## 푸리에 급수 _Fourier series_



수학자들은 이제 삼각함수, 지수함수등의 예쁘지만(무한히 미분 가능한) 어려운 함수를 다항식으로 바꿀 수 있게 되었다. 그런데 어느 날 푸리에 _Fourier_ 라는 아저씨는 이런 생각이 들었나 보다.

*삼각함수는 다항식으로 바꿀 수 있는데, 다른 함수를 삼각함수의 합으로 바꿀 수는 없을까?* 

정확히는 *heat equation*이라는 편미분방정식을 푸는 도중이었다고 하는데, 아무튼 이 아저씨도 떠오른 아이디어를 놓치지 않았다. 테일러가 자기 이름을 교과서에 올린것이 부러웠는지, 푸리에도 주기함수를 $\sin$과 $\cos$의 합으로 표현하는 법을 만들고 자기 이름을 붙이는 데 성공한 것이다.  

구체적인 수식을 보자. 주기가 $T$인 함수 $f$에 대해, $T=2L$이라 놓으면

$$ f(x) = a_0 + \sum\limits_{n=1}^{\infty}(a_n \cos(\frac{n\pi }{L}x) + b_n \sin(\frac{n\pi }{L}x)) $$

$$ a_0 = \frac{1}{2L} \int_T f(x)dx $$ 

$$ a_n = \frac{1}{L} \int_T f(x)\cos(\frac{n\pi}{L} x)dx $$ 

$$ b_n = \frac{1}{L} \int_T f(x)\sin(\frac{n\pi}{L} x)dx $$ 

갑자기 적분도 나오고 테일러 아저씨의 식보다는 많이 복잡해졌기 때문에 하나씩 뜯어서 천천히 따라가보자. 

## 삼각함수의 합? 

우선 삼각함수의 합으로 표현한다는 것이 무슨 뜻인지 생각해보자. 

$f(x)$가 다항식, 즉 $x$들의 조합으로 표현된다는 것은 아래와 같았다.
$$ f(x) = a_0 + a_1x + a_2x^2 + \dotsm$$

$$ = a_0 + \sum\limits_{n=1}^{\infty}a_nx^n$$

그렇다면 왜 삼각함수의 합으로 표현된다는 것을 아래처럼 쓰지 않았을까?
$$ f(x) = a_0 + (a_1\cos{x} + a_2\cos^2{x} + \dotsm) + (b_1\sin{x} + b_2\sin^2{x} + \dotsm)$$

$$ = a_0 + \sum\limits_{n=1}^{\infty}(a_n\cos^n{x} + a_n\sin^n{x}) $$

추측하건대, $x^2$, $x^3$들을 $x$의 합으로 쪼갤 수 없었던 것과 달리 삼각함수의 거듭제곱은 제곱이 붙지 않은 삼각함수들로 분해될 뿐만 아니라 그 기하학적 의미를 파악하기도 어렵기 때문일 것이다. 

> $$\sin^2(x) = \frac{1 - \cos(2x)}{2} $$
> 
> $$\sin^3(x) = \frac{3\sin(x) - \sin(3x)}{4} $$

그럼 어떻게 할까? 위의 $\sin$거듭제곱들이 어떻게 쪼개지는지 보면 알 수 있겠지만, 삼각함수의 기하학적 의미를 생각하면 다항식처럼 차수가 아니라 변수 앞에 곱해지는 숫자로 나누는게 더 자연스럽다. 

<p align="middle"><iframe src="https://www.desmos.com/calculator/d6etv2tzoj?embed" width="500px" height="200px" style="border: 1px solid #ccc" frameborder=0></iframe></p>

$$\sin(x), \sin(2x) $$

<p align="middle"><iframe src="https://www.desmos.com/calculator/vwsyxrdrke?embed" width="500px" height="200px" style="border: 1px solid #ccc" frameborder=0></iframe></p>

$$\sin(x), \sin(3x) $$

위 그래프를 자세히 보자. $\sin(x)$가 한 번 진동할 때(같은 모양이 한번 나오는 동안), $\sin(2x)$는 2번 진동하고, $\sin(3x)$는 3번 진동한다. 

즉, __$\sin(nx)$는 $\sin(x)$보다 n배 빠르게 진동하는 파동이다__. 

이를 바꿔 말하면, $\sin(x)$의 주기가 $2\pi$이므로, n배 빠르게 진행하는 $\sin(nx)$의 주기는 $\frac{2\pi}{n}$이란 뜻이다. 

주기를 기준으로 좀더 보기 쉽게 바꾸면, __$\sin(\frac{2\pi}{T}x)$의 주기는 $T$이다__. 


## $\frac{n\pi }{L}$, 주기가 $T$이다 ##

주기가 $T$라는 것은 어떤 점 $a$에서의 값과 $T$만큼의 간격을 둔 곳의 값, 즉 $a-T$와 $a+T$의 값이 같다는 뜻이다. 마찬가지로  $a-T$에서의 값은  $a-2T$ 와 $a$와 에서의 값과 같고, 무한히 반복하므로 이를 수학적으로 예쁘게 써보면
$$ f(x) = f(x + Tn), n은 정수 $$ 
라는 뜻이다. 

주기가 1이고, [0, 0.5)에선 $\frac{\pi}{4}$, [0.5, 1)에선 $-\frac{\pi}{4}$의 값을 갖는 함수 $f(x)$를 생각해보자. 

<p align="middle">
<iframe src="https://www.desmos.com/calculator/drrtwksxwa?embed" width="500px" height="300px" style="border: 1px solid #ccc" frameborder=0></iframe>
</p>

$$f(x)$$
이건 예제로 들기 위해 만든 억지함수가 아니라 전자/컴퓨터공학에서 실제로 쓰는 사각파*square wave*라는 친구다. 
이걸 삼각함수의 합으로 표현할 수 있을까? 

<p align="middle">
<iframe src="https://www.desmos.com/calculator/kma7vpefrt?embed" width="500px" height="300px" style="border: 1px solid #ccc" frameborder=0></iframe>
</p>

$$f(x), \sin(x)$$

음.. 순정 $\sin(x)$로는 딱봐도 힘들 것 같다. 우리의 $f(x)$는 1을 간격으로 같은 값을 같기 때문에, 1 간격으로 잘라보면 계속 다른 값을 갖는 $\sin(x)$로 표현하기 힘든 것이다. 
그러면 $f(x)$ 처럼 주기가 1인 삼각함수를 만들어보자. 

<p align="middle">
<iframe src="https://www.desmos.com/calculator/jgdisprbcm?embed" width="500px" height="300px" style="border: 1px solid #ccc" frameborder=0></iframe>
</p>

$$f(x), \sin(2\pi x)$$

아직 차이가 크지만, 대충 느낌이 비슷해졌다. 적어도 같은 주기로 반복되므로 적당히 가공하면 $f(x)$를 만들 수 있을 것도 같다. 그런데 주기가 1인 $\sin$함수는 이것만 있는게 아니다. 

<p align="middle">
<iframe src="https://www.desmos.com/calculator/gzjner0cx1?embed" width="500px" height="300px" style="border: 1px solid #ccc" frameborder=0></iframe>
</p>

$$f(x), \sin(4\pi x)$$

(고유)주기가 0.5인 $\sin(4\pi x)$라고 해도, 1을 간격으로 잘라보면 같은 값을 가진다. 1이 지나는 동안 모양이 2번 반복됐을 뿐이다. 

따라서, 직관적으로 생각해봤을 때 고유주기가 $1, \frac{1}{2}, \dotsm,\frac{1}{n}$인 모든 $\sin$함수들은 주기가 1인 함수를 조합하는 재료로 쓸 수 있을 것 같다. 

이제 $\frac{n\pi }{L} = \frac{2\pi n}{T}$가 어떤 뜻인지 보인다. $\frac{2\pi}{T}$가 곱해졌다는 것은 주기가 $T$로 바뀌었다는 뜻이고, 덧붙은 $n$은 주기 $T$동안 모양이 몇번 반복되는지를 나타낸다. 

즉 $\frac{2\pi n}{T}$들을 합한다는 것은, __함수 $f(x)$의 주기인 $T$ 간격으로 잘라봤을 때 같은 값이 나오는 모든 파동을 더한다는 것을 의미하는 것이다__.

## 푸리에 급수 유도하기 - 주기동안 적분하시오


정의를 다시 살펴보자. 

$$ f(x) = a_0 + \sum\limits_{n=1}^{\infty}(a_n \cos(\frac{n\pi }{L}x) + b_n \sin(\frac{n\pi }{L}x)) $$




위의 식이 주기가 $T$인 모든 파동에 적당한 값을 곱해 더한다는 것은 이제 알겠는데, 그 적당한 값을 구할 수 없으면 의미가 없다. 
이 적당한 값들은 멋있는 용어로 계수 _coefficients_ 라고 하는데, 미분하고 0 넣으면 끝났던 테일러 아저씨때 보다는 머리를 좀 굴려야 한다. 하지만 그 아이디어는 똑같이 적용할 수 있다. 

$$ f(x) = a_0 + a_1x + a_2x^2 + \dotsm$$

테일러 급수의 첫 번째 계수 $a_0$을 구하기 위해 $x$에 0을 대입했던 이유가 뭐였는지 생각해보자. $a_1, a_2, \dotsm$들을 지우고 싶었기 때문이었다.

그럼 푸리에 급수에 0을 대입해보면?

$$ f(0) = a_0 + \sum\limits_{n=1}^{\infty}(a_n \cos(\frac{n\pi }{L}0) + b_n \sin(\frac{n\pi }{L}0)) $$

$$= a_0 + \sum\limits_{n=1}^{\infty}(a_n \cos(0) + b_n\sin (0)) $$

$$= a_0 + \sum\limits_{n=1}^{\infty}(a_n * 1 + b_n * 0) $$

$$= a_0 + \sum\limits_{n=1}^{\infty}a_n  $$

$b_n$은 지워졌지만 $a_n$이 고스란히 남았다. 이와 같이 $\sin$과 $\cos$을 동시에 0으로 만드는 값은 없기 때문에 대입해서 두 계수들을 동시에 지우는 건 힘들어 보인다. 
하지만 다행스럽게도, 대입보다는 조금 복잡하지만 $\sin$과 $\cos$을 동시에 0으로 만드는 법은 존재한다. 바로 **적분**이다. 

> $$ \int_{-\pi}^{\pi} \cos(x)dx = \int_{-\pi}^{\pi} \sin(x)dx =0 $$ 

<p align="middle">
<iframe src="https://www.desmos.com/calculator/xx65om3vjb?embed" width="500px" height="200px" style="border: 1px solid #ccc" frameborder=0></iframe>
</p>

$$ \sin(x) $$

$\sin(x)$의 그래프를 자세히 보면, 주기가 $2\pi$라는 것 외에 $\pi$를 주기로 같은 모양이 위 아래로 솟았다 들어가는게 보일 것이다. 즉 $\int_{-\pi}^{0} \sin(x)dx$와 $\int_{0}^{\pi} \sin(x)dx$이 의미하는 것, $-\pi$에서 0까지 $\sin(x)$와 $x$축 사이의 넓이와 0부터 $\pi$까지의 넓이가 같고 방향은 반대이기 때문에, 두 합은 정확히 0이라는 뜻이다. 

$x$에 무얼 곱해도, 그 주기가 바뀔 뿐 한 주기동안 위 아래로 대칭인 같은 모양을 그리는 것은 변하지 않기 때문에, **삼각함수를 한 주기동안 적분하면 항상 0이 된다**.

> $$\int_T\cos\frac{n\pi }{L}x dx = \int_T\sin\frac{n\pi }{L}x dx = 0$$

엥? $T$가 갑자기 튀어나왔는데요?

$T$는 $\cos(\frac{n\pi }{L}x)$와 $\sin(\frac{n\pi }{L}x)$의 주기이다. 이 함수들이 그리는 모양이 반복되기 때문에, 어디서 시작해서 $T$만큼의 넓이를 구해도 같은 결과가 나오기 때문에 이렇게 쓴 것이다. 즉 $[-T/2, T/2]$이든 $[0, T]$이든 아무거나 넣어도 똑같다. 

그럼 이제 양변을 적분해서 $a_0$외의 값을 지워보자. 

$$  \int_ Tf(x) dx=  \int_T [a_0 + \sum\limits_{n=1}^{\infty}(a_n \cos(\frac{n\pi }{L}x) + b_n \sin(\frac{n\pi }{L}x))]dx $$



$$  \int_ Tf(x) dx=  \int_T a_0dx +\sum\limits_{n=1}^{\infty}( a_n \int_T\cos(\frac{n\pi }{L}x)dx +  b_n \int_T\sin(\frac{n\pi }{L}x)dx) $$


$$  \int_ Tf(x) dx=  a_0x|_T + \sum\limits_{n=1}^{\infty}(a_n [\frac{L}{n\pi}\sin(\frac{n\pi }{L}x)]_{T} + b_n [\frac{L}{n\pi}-\cos(\frac{n\pi }{L}x)]_{T}) $$

실제 적분을 해보면 이렇게 된다. 0으로 만들려고 한 주기동안 적분을 한 것이므로 계산을 안해봐도 0이겠지만, 궁금하면 직접 계산해 보시길. 

$$  \int_ Tf(x) dx=  a_0T + \sum\limits_{n=1}^{\infty}(a_n *0 + b_n *0) $$

$$ \therefore a_0 = \frac{1}{T} \int_ Tf(x) dx = \frac{1}{2L} \int_ Tf(x) dx $$ 

$a_0$을 구해내는데 성공했다.

이제 $a_1,a_2\dotsm$들과 $b_1,b_2\dotsm$들을 구하는 일만 남았다.

마찬가지로 테일러 급수에서 이 값들을 구할 때는 했던 일을 떠올려보자. 테일러 급수는 말을 잘듣는 다항식이었기 때문에, 양변을 미분하자 $a_0$이 지워졌고, $a_2, a_3, \dotsm$들은 쉽게 지울 수 있는 모양으로 바뀌었었다. 

하지만 삼각함수는 끈질긴 녀석들이라, 양변을 미분해도 모양을 조금 바꿀 뿐 고스란히 살아남는다. 

$$ f(x) = a_0 + \sum\limits_{n=1}^{\infty}(a_n \cos(\frac{n\pi }{L}x) + b_n \sin(\frac{n\pi }{L}x)) $$

$$ f'(x) = \sum\limits_{n=1}^{\infty}(-\frac{n\pi}{L}a_n \sin(\frac{n\pi }{L}x) + \frac{n\pi}{L}b_n \cos(\frac{n\pi }{L}x)) $$

따라서 비슷하지만 다른 전략을 사용해야 한다. $a_0$을 구했을 때와 마찬가지로 **삼각함수를 한 주기동안 적분하면 항상 0이 된다**는 사실을 이용해보자. 

$a_0$에는 이제 볼일이 끝났으므로, 지우고 싶다. 주기 $T$만큼 적분해서 $a_0$을 지우려면, **주기가 $T$인 삼각함수를 곱해주면 된다**. 

> $$\int_Ta_0\cos(\frac{m\pi }{L}x) dx = a_0\int_T\cos(\frac{m\pi }{L}x) dx = 0 $$
> 
> $$\int_Ta_0\sin(\frac{m\pi }{L}x) dx =a_0\int_T\sin(\frac{m\pi }{L}x) dx = 0$$


그럼 나머지 항들은 어떻게 될까? 여기부터는 그림을 그려서 생각해보자. 

<p align="middle">
<iframe src="https://www.desmos.com/calculator/68rzprrsfy?embed" width="500px" height="200px" style="border: 1px solid #ccc" frameborder=0></iframe>
</p>

$$ \sin(x)\cos(2x) $$

<p align="middle">
<iframe src="https://www.desmos.com/calculator/0yyvxwnezr?embed" width="500px" height="200px" style="border: 1px solid #ccc" frameborder=0></iframe>
</p>

$$ \sin(2x)\cos(2x) $$


<p align="middle">
<iframe src="https://www.desmos.com/calculator/kserh79mrg?embed" width="500px" height="200px" style="border: 1px solid #ccc" frameborder=0></iframe>
</p>

$$ \sin(3x)\cos(2x) $$

한 주기동안 적분을 하면, 즉 위 아래로 솟은 모양들을 퍼즐처럼 맞춰보면 똑같은 모양이 위 아래에 한 조각씩 생기는게 보이는가? 예를 들어서 $\sin$함수가 -0.5, 0.5, -0.5, 0.5로 진동하는 동안 $\cos$함수는 -1, 0, 1, 0으로 값이 변하면서 각각을 곱하고 더하는 과정에서 값이 상쇄된 것이다.

즉 **삼각함수를 한 주기동안 적분하면 항상 0**인 것과 마찬가지로, **두 삼각함수의 곱을 한 주기동안 적분해도 0이 된다**. 

단, 같은 주파수를 갖는 같은 삼각함수의 곱은 상쇄되지 않고, 음수일때 똑같은 음수가 나와 곱해서 양수가 되기 때문에 아래로 솟을 모양이 위로 솟고, 적분하면 값을 갖는다.

> 삼각함수의 직교성 *orthogonality*
> $$ \int_T\sin(\frac{n\pi }{L}x)\cos(\frac{m\pi }{L}x) dx = 0$$   
> 
> $$ \int_T\cos(\frac{n\pi }{L}x)\cos(\frac{m\pi }{L}x) dx = 0, (m\neq n)$$  
> 
> $$ \int_T\cos(\frac{n\pi }{L}x)\cos(\frac{m\pi }{L}x) dx =   \int_T\cos^2(\frac{n\pi }{L}x)dx) =  L, (m= n)$$   
> $$ \int_T\cos(\frac{n\pi }{L}x)\sin(\frac{m\pi }{L}x) dx = 0$$   
> 
> $$ \int_T\sin(\frac{n\pi }{L}x)\sin(\frac{m\pi }{L}x) dx =  0, (m \neq n)$$   
> 
>  $$ \int_T\sin(\frac{n\pi }{L}x)\sin(\frac{m\pi }{L}x) dx =   \int_T\sin^2(\frac{n\pi }{L}x)dx = L, (m= n)$$   


위 성질을 이용해 $a_m$을 구해보자. 

$$ f(x) = a_0 + \sum\limits_{n=1}^{\infty}(a_n \cos(\frac{n\pi }{L}x) + b_n \sin(\frac{n\pi }{L}x)) $$

양변에 $cos(\frac{m\pi }{L}x)$ 를 곱하면 
$$ f(x)cos(\frac{m\pi }{L}x) = a_0cos(\frac{m\pi }{L}x) + \sum\limits_{n=1}^{\infty}(a_n \cos(\frac{n\pi }{L}x)cos(\frac{m\pi }{L}x) + b_n \sin(\frac{n\pi }{L}x)cos(\frac{m\pi }{L}x)) $$

주기 $T$동안 적분하면

$$ \int_Tf(x)cos(\frac{m\pi }{L}x)dx = \int_Ta_0cos(\frac{m\pi }{L}x)dx + \int_T[\sum\limits_{n=1}^{\infty}(a_n \cos(\frac{n\pi }{L}x)cos(\frac{m\pi }{L}x) + b_n \sin(\frac{n\pi }{L}x)cos(\frac{m\pi }{L}x))]dx $$

$$  \int_Ta_0cos(\frac{m\pi }{L}x)dx = 0 $$ 
이고, 

$$ \int_T[\sum\limits_{n=1}^{\infty}a_n \cos(\frac{n\pi }{L}x)\cos(\frac{m\pi }{L}x)]dx  $$

$$ = [\sum\limits_{n=1}^{\infty}(\int_Ta_n \cos(\frac{n\pi }{L}x)\cos(\frac{m\pi }{L}x)dx) $$

$$ = \int_T(a_1 \cos(\frac{1\pi }{L}x)\cos(\frac{m\pi }{L}x)]dx + \dotsm +  \int_T(a_m \cos(\frac{m\pi }{L}x)\cos(\frac{m\pi }{L}x)]dx + \dotsm$$

$$ = 0 + \dotsm + a_m \int_T(a_m \cos(\frac{m\pi }{L}x)\cos(\frac{m\pi }{L}x)]dx + \dotsm$$

$$ = a_m L $$

$$ \int_T[\sum\limits_{n=1}^{\infty}a_n \sin(\frac{n\pi }{L}x)\cos(\frac{m\pi }{L}x)]dx  $$

$$ = [\sum\limits_{n=1}^{\infty}(\int_Ta_n \sin(\frac{n\pi }{L}x)\cos(\frac{m\pi }{L}x)dx) $$

$$ = \int_T(a_1 \cos(\frac{1\pi }{L}x)\cos(\frac{m\pi }{L}x)]dx + \dotsm +  \int_T(a_m \sin(\frac{m\pi }{L}x)\cos(\frac{m\pi }{L}x)]dx + \dotsm$$

$$ = 0 + \dotsm + 0 + \dotsm$$

$$ = 0 $$

이므로, 

$$ \int_Tf(x)cos(\frac{m\pi }{L}x)dx = 0 + a_m L + 0 = a_mL $$

$$ \therefore  a_m = \frac{1}{L} \int_Tf(x)cos(\frac{m\pi }{L}x)dx$$

$$  a_n = \frac{1}{L} \int_Tf(x)cos(\frac{n\pi }{L}x)dx$$

마찬가지 방법으로 $\sin$앞에 붙은 계수 $b_n$도 구해보면

$$ b_n = \frac{1}{L} \int_T f(x)\sin(\frac{n\pi}{L} x)dx $$ 

이제 우리는 주기함수 $f(x)$를 삼각함수의 합으로 표현할 수 있게 된 것이다.




<p align="middle">

</p>





## 푸리에 급수의 활용

주기가 1이고, [0, 0.5)에선 $\frac{\pi}{4}$, [0.5, 1)에선 $-\frac{\pi}{4}$의 값을 갖는 함수 $f(x)$, 그니까 사각파를 삼각함수의 합으로 바꿔보자. 
$T=1$, $L = T/2 = 0.5$이다.



$$ f(x) = a_0 + \sum\limits_{n=1}^{\infty}(a_n \cos(\frac{n\pi }{L}x) + b_n \sin(\frac{n\pi }{L}x))$$

$$ a_0 = $$

$$ a_0 = \frac{1}{2L} \int_ Tf(x) dx $$ 

$$ = \frac{1}{2 * 0.5} \int_0^1 f(x)dx $$

$$ = 0 $$

$$ a_n = \frac{1}{L} \int_T f(x)\cos(\frac{n\pi}{L}x)dx $$

$$ = 2 \int_{0}^{1} f(x)\cos(2n\pi x)dx $$

$$ = 2 [\int_{0}^{0.5} \frac{\pi}{4}\cos(2n\pi x)dx +\int_{0.5}^{1} -\frac{\pi}{4}\cos(2n\pi x)dx ]$$

$$ = 2[\frac{\pi}{4} \frac{1}{2n\pi}\sin(2n\pi x)|_{0}^{0.5} -  \frac{\pi}{4} \frac{1}{2n\pi}\sin(2n\pi x)|_{0.5}^{1}  $$

$$ = \frac{1}{4n}[(\sin( n \pi) - \sin(0)) - (\sin(2n\pi) - \sin(n\pi))]$$

$$ = 0 $$

$$ b_n = \frac{1}{L} \int_T f(x)\sin(\frac{n\pi}{L}x)dx $$

$$ = 2 \int_{0}^{1} f(x)\sin(2n\pi x)dx $$

$$ = 2 [\int_{0}^{0.5} \frac{\pi}{4}\sin(2n\pi x)dx +\int_{0.5}^{1} -\frac{\pi}{4}\sin(2n\pi x)dx ]$$

$$ = 2[-\frac{\pi}{4} \frac{1}{2n\pi}\cos(2n\pi x)|_{0}^{0.5} +  \frac{\pi}{4} \frac{1}{2n\pi}\cos(2n\pi x)|_{0.5}^{1}  $$

$$ = \frac{1}{4n}[-(\cos( n \pi) - \cos(0)) + (\cos(2n\pi) - \cos(n\pi))]$$

$$ = \frac{1}{n} (n은 홀수), 0(n은 짝수) $$

$$ \therefore f(x) = \sum\limits_{n=1}^{\infty} \frac{1}{2n-1} \sin(2(2n-1)\pi x)$$

$$ = \sin(2\pi x) + \frac{\sin(6\pi x)}{3} + \frac{\sin(10\pi x)}{5} + \dotsm $$

역시 푸리에 아저씨가 거짓말을 친 건 아닌지 눈으로 확인해보자. 

<p align="middle">
<iframe src="https://www.desmos.com/calculator/drrtwksxwa?embed" width="500px" height="300px" style="border: 1px solid #ccc" frameborder=0></iframe>
</p>

$$f(x)$$





<p align="middle"><iframe src="https://www.desmos.com/calculator/l3aowjzggm?embed" width="500px" height="300px" style="border: 1px solid #ccc" frameborder=0></iframe></p>

$$f(x), \sin(2\pi x)$$

<p align="middle"><iframe src="https://www.desmos.com/calculator/vbm01rgrou?embed" width="500px" height="300px" style="border: 1px solid #ccc" frameborder=0></iframe></p>

$$f(x),\sin\left(2\pi x\right)+\frac{\sin(6\pi x)}{3}$$

<p align="middle"><iframe src="https://www.desmos.com/calculator/4fyhwp5rwu?embed" width="500px" height="300px" style="border: 1px solid #ccc" frameborder=0></iframe></p>

$$f(x),\sin\left(2\pi x\right)+\frac{\sin(6\pi x)}{3}+\dotsm + \frac{\sin(38\pi x)}{19}$$

<p align="middle"><iframe src="https://www.desmos.com/calculator/ilk8txcei7?embed" width="500px" height="300px" style="border: 1px solid #ccc" frameborder=0></iframe></p>

$$f(x),\sin\left(2\pi x\right)+\frac{\sin(6\pi x)}{3}+\dotsm + \frac{\sin(398\pi x)}{199}$$

아직은 조금 울퉁불퉁하지만, 무한히 더하면 정말 한없이 가까워질 것 같다. 

그래서 이 짓거리를 왜 하냐면.. 우선 푸리에 변환까지 얘기를 마쳐야 실제 예시를 들어줄 수 있다. 다른 분야에서는 모르겠지만 컴퓨터 공학도들이 다루는 디지털 신호처리는 말 그대로 디지털 신호가 입력으로 들어가기 때문에, 연속이자 주기함수 얘기인 푸리에 급수는 아직 빌드업에 불과하기 때문이다. 

이제 비주기 함수 얘기인 푸리에 변환과, 불연속적 데이터를 다루는 DTFT, DFT 얘기로 넘어가보자. 
(계속)

